<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Schoolgy</title>
<link href="https://fonts.googleapis.com/css2?family=Amatic+SC:wght@700&display=swap" rel="stylesheet">
<style>
  *{margin:0;padding:0;box-sizing:border-box;}
  body{
    background:#09060f;color:#fff;
    font-family:'Amatic SC',cursive;
    min-height:100vh;display:flex;flex-direction:column;
    align-items:center;justify-content:center;overflow:hidden;
  }
  .orb{position:fixed;border-radius:50%;filter:blur(80px);pointer-events:none;animation:drift 12s ease-in-out infinite alternate;}
  .orb1{width:500px;height:500px;background:rgba(124,58,237,0.25);top:-100px;left:-100px;}
  .orb2{width:400px;height:400px;background:rgba(168,85,247,0.2);bottom:-80px;right:-80px;animation-delay:-5s;}
  .orb3{width:280px;height:280px;background:rgba(34,211,238,0.1);top:40%;left:55%;animation-delay:-9s;}
  @keyframes drift{from{transform:translate(0,0) scale(1);}to{transform:translate(28px,18px) scale(1.07);}}

  .particles{position:fixed;inset:0;pointer-events:none;}
  .particle{position:absolute;border-radius:50%;background:rgba(168,85,247,0.55);animation:floatUp linear infinite;}
  @keyframes floatUp{0%{transform:translateY(100vh) scale(0);opacity:0;}10%{opacity:1;}90%{opacity:0.3;}100%{transform:translateY(-5vh) scale(1);opacity:0;}}

  .card{
    position:relative;z-index:10;text-align:center;
    padding:2.5rem 3rem;
    background:rgba(12,6,28,0.85);
    border:1px solid rgba(168,85,247,0.3);
    border-radius:24px;max-width:460px;width:90vw;
    backdrop-filter:blur(20px);
    box-shadow:0 0 60px rgba(124,58,237,0.3),inset 0 1px 0 rgba(255,255,255,0.06);
    animation:cardIn 0.7s cubic-bezier(0.34,1.5,0.64,1) both;
  }
  @keyframes cardIn{from{transform:translateY(40px) scale(0.93);opacity:0;}to{transform:translateY(0) scale(1);opacity:1;}}

  .logo{
    font-size:3rem;
    background:linear-gradient(90deg,#fff,#ddd6fe,#c4b5fd,#a855f7);
    -webkit-background-clip:text;background-clip:text;color:transparent;
    margin-bottom:0.3rem;animation:glowPulse 3s ease infinite;
  }
  @keyframes glowPulse{0%,100%{filter:drop-shadow(0 0 8px rgba(168,85,247,0.5));}50%{filter:drop-shadow(0 0 22px rgba(168,85,247,0.9));}}

  .spinner-wrap{margin:1.3rem auto;width:64px;height:64px;position:relative;}
  .ring{position:absolute;inset:0;border-radius:50%;border:3px solid transparent;animation:spin linear infinite;}
  .ring:nth-child(1){border-top-color:#a855f7;animation-duration:1.4s;}
  .ring:nth-child(2){inset:8px;border-right-color:#7c3aed;animation-duration:1.9s;animation-direction:reverse;}
  .ring:nth-child(3){inset:16px;border-bottom-color:#22d3ee;animation-duration:2.4s;}
  @keyframes spin{to{transform:rotate(360deg);}}
  .dot{position:absolute;inset:28px;border-radius:50%;background:radial-gradient(circle,#c4b5fd,#7c3aed);animation:dotPulse 1.4s ease-in-out infinite;}
  @keyframes dotPulse{0%,100%{transform:scale(1);}50%{transform:scale(1.35);}}

  .status{font-size:1.75rem;color:rgba(196,181,253,0.85);margin-bottom:0.3rem;min-height:2.2rem;}
  .sub{font-size:1.2rem;color:rgba(196,181,253,0.4);margin-bottom:1.4rem;min-height:1.5rem;}
  .prog-track{width:100%;height:4px;background:rgba(255,255,255,0.07);border-radius:4px;overflow:hidden;margin-bottom:1.6rem;}
  .prog-fill{height:100%;width:0%;background:linear-gradient(90deg,#7c3aed,#a855f7,#22d3ee);border-radius:4px;transition:width 0.45s ease;box-shadow:0 0 10px rgba(168,85,247,0.8);}

  .fallback{display:none;animation:fadeIn 0.5s ease both;}
  @keyframes fadeIn{from{opacity:0;transform:translateY(8px);}to{opacity:1;transform:translateY(0);}}
  .fb-title{font-size:2rem;color:#f0e6ff;margin-bottom:0.5rem;}
  .fb-text{font-size:1.2rem;color:rgba(196,181,253,0.6);line-height:1.65;margin-bottom:1.2rem;}
  .fb-text strong{color:#c4b5fd;}
  .fb-steps{
    text-align:left;
    background:rgba(124,58,237,0.1);border:1px solid rgba(168,85,247,0.2);
    border-radius:12px;padding:0.9rem 1.1rem;margin-bottom:1.4rem;
    font-size:1.15rem;color:rgba(196,181,253,0.7);line-height:2.2;
  }
  .open-btn{
    display:inline-flex;align-items:center;gap:8px;
    padding:0.85rem 2rem;
    background:linear-gradient(90deg,#7c3aed,#a855f7);
    border:none;border-radius:14px;color:#fff;
    font-family:'Amatic SC',cursive;font-size:1.8rem;
    cursor:pointer;letter-spacing:0.05em;
    box-shadow:0 0 24px rgba(168,85,247,0.5);
    transition:transform 0.15s,opacity 0.15s,box-shadow 0.15s;
  }
  .open-btn:hover{transform:translateY(-2px);opacity:0.9;box-shadow:0 0 36px rgba(168,85,247,0.7);}
  .open-btn:active{transform:translateY(0);}
  .cloak-tag{
    display:inline-flex;align-items:center;gap:6px;
    background:rgba(168,85,247,0.1);border:1px solid rgba(168,85,247,0.22);
    border-radius:20px;padding:4px 12px;
    font-size:1.05rem;color:rgba(196,181,253,0.55);margin-top:0.9rem;
  }
  .cloak-tag img{width:14px;height:14px;border-radius:3px;}
</style>
</head>
<body>

<div class="orb orb1"></div>
<div class="orb orb2"></div>
<div class="orb orb3"></div>
<div class="particles" id="particles"></div>

<div class="card">
  <div class="logo">Schoolgy 5.0</div>

  <div id="loadingState">
    <div class="spinner-wrap">
      <div class="ring"></div><div class="ring"></div><div class="ring"></div>
      <div class="dot"></div>
    </div>
    <div class="status" id="statusTxt">Initializing...</div>
    <div class="sub" id="subTxt">Preparing your session</div>
    <div class="prog-track"><div class="prog-fill" id="prog"></div></div>
  </div>

  <div class="fallback" id="fallback">
    <div class="fb-title" id="fbTitle">ðŸš« Popup Blocked</div>
    <div class="fb-text" id="fbText">
      Your browser blocked the automatic launch.<br>
      <strong>Schoolgy</strong> needs a new tab to stay hidden from monitoring.
    </div>
    <div class="fb-steps" id="fbSteps">
      â‘  Look for a <strong style="color:#c4b5fd">ðŸš« popup blocked</strong> icon in your address bar<br>
      â‘¡ Click it and select <strong style="color:#c4b5fd">"Always allow popups"</strong><br>
      â‘¢ Or just click the button below to open manually
    </div>
    <button class="open-btn" id="openBtn">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
      Open Schoolgy
    </button>
    <div class="cloak-tag" id="cloakTag"></div>
  </div>
</div>

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Set this to your GitHub Pages URL after uploading schoolgy-app.html
// e.g. https://yourusername.github.io/schoolgy-app/
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const APP_URL = "https://YOUR_GITHUB_USERNAME.github.io/schoolgy-app/";

const DEP = "https://raw.githubusercontent.com/SchoolgyGames/SchoolgyDepenencies/main";
const CLOAKS = [
  { title:"Clever | Portal",  icon: DEP + "/clever.png"    },
  { title:"IXL | Dashboard",  icon: DEP + "/ixl.png"       },
  { title:"Schoology | Home", icon: DEP + "/schoology.png" },
];
const cloak = CLOAKS[Math.floor(Math.random() * CLOAKS.length)];

// Particles
(function(){
  const w = document.getElementById('particles');
  for(let i=0;i<30;i++){
    const p=document.createElement('div'); p.className='particle';
    p.style.cssText=`left:${Math.random()*100}vw;width:${Math.random()*3+1.5}px;height:${Math.random()*3+1.5}px;animation-duration:${Math.random()*13+7}s;animation-delay:${Math.random()*-16}s;opacity:${Math.random()*0.4+0.15};`;
    w.appendChild(p);
  }
})();

// Progress steps
const steps=[
  {pct:15,s:"Selecting cloakâ€¦",    b:"Randomizing tab identity"},
  {pct:38,s:"Preparing sessionâ€¦",  b:"Loading Schoolgy environment"},
  {pct:65,s:"Opening new tabâ€¦",    b:"Bypassing filters"},
  {pct:88,s:"Launchingâ€¦",          b:"Almost there!"},
  {pct:100,s:"Done!",              b:"Enjoy ðŸŽ®"},
];
let si=0;
const prog=document.getElementById('prog');
const sTxt=document.getElementById('statusTxt');
const bTxt=document.getElementById('subTxt');
function tick(){ if(si>=steps.length)return; const s=steps[si++]; prog.style.width=s.pct+'%'; sTxt.textContent=s.s; bTxt.textContent=s.b; if(si<steps.length)setTimeout(tick,300+Math.random()*180); }
setTimeout(tick,250);

// Launch: opens a new tab, writes a tiny redirect page that sets sessionStorage
// for the cloak then navigates to APP_URL on GitHub Pages.
// The app itself fetches everything from GitHub Pages â€” no CORS issues.
function doLaunch(){
  const w = window.open('','_blank');
  if(!w||w.closed) return false;

  // Escape the values for safe embedding in a JS string
  const safeTitle = cloak.title.replace(/'/g,"\\'");
  const safeIcon  = cloak.icon.replace(/'/g,"\\'");
  const safeURL   = APP_URL.replace(/'/g,"\\'");

  w.document.open();
  w.document.write(`<!DOCTYPE html><html><head>
<meta charset="UTF-8">
<title>${cloak.title}</title>
<link rel="icon" href="${cloak.icon}" type="image/png">
<style>*{margin:0;padding:0;}html,body{width:100%;height:100%;background:#09060f;display:flex;align-items:center;justify-content:center;font-family:sans-serif;color:rgba(196,181,253,0.4);font-size:1rem;}</style>
</head><body><span>Loading Schoolgy\u2026</span>
<script>
try{sessionStorage.setItem('schoolgy_cloak',JSON.stringify({title:'${safeTitle}',icon:'${safeIcon}'}));}catch(e){}
location.replace('${safeURL}');
<\/script></body></html>`);
  w.document.close();
  return true;
}

// Auto-launch after animations settle
setTimeout(function(){
  const launched = doLaunch();

  const loadEl=document.getElementById('loadingState');
  const fallEl=document.getElementById('fallback');
  const openBtn=document.getElementById('openBtn');
  const cloakTag=document.getElementById('cloakTag');
  const fbTitle=document.getElementById('fbTitle');
  const fbText=document.getElementById('fbText');
  const fbSteps=document.getElementById('fbSteps');

  cloakTag.innerHTML=`<img src="${cloak.icon}" onerror="this.style.display='none'"> Cloaked as: ${cloak.title}`;

  if(launched){
    prog.style.width='100%'; sTxt.textContent='âœ“ Launched!'; bTxt.textContent='Check your new tab';
    setTimeout(()=>{
      loadEl.style.transition='opacity 0.4s'; loadEl.style.opacity='0';
      setTimeout(()=>{
        loadEl.style.display='none';
        fbTitle.textContent='âœ“ Opened Successfully';
        fbText.innerHTML='Schoolgy is open in a new tab, cloaked as <strong>'+cloak.title+'</strong>.';
        fbSteps.style.display='none';
        openBtn.innerHTML='&#8599; Re-open';
        openBtn.onclick=function(){ doLaunch(); };
        fallEl.style.display='block';
      },400);
    },900);
  } else {
    loadEl.style.display='none';
    fallEl.style.display='block';
    openBtn.onclick=function(){
      if(!doLaunch()) alert('Still blocked â€” allow popups for this site in your address bar, then try again.');
    };
  }
}, 1600);
</script>
</body>
</html>
